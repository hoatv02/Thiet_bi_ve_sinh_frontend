<section class="container-app my-10">
  <!-- Breadcrumb -->
  <div class="text-sm text-gray-500 mb-6">
    <a (click)="goHome()" class="hover:text-[#00456F]">Trang ch·ªß</a> /
    <a (click)="goCart()" class="hover:text-[#00456F]">Gi·ªè h√†ng</a> /
    <span class="text-gray-700 font-medium">ƒê·∫∑t h√†ng</span>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-10 gap-8">
    <!-- üß± C·ªòT TR√ÅI (3/10): ƒêƒÉng nh·∫≠p & Th√¥ng tin thanh to√°n -->
    <div class="lg:col-span-3 bg-white shadow-[0_4px_20px_rgba(9,9,81,0.05)] rounded-lg p-6">
      <!-- ƒêƒÉng nh·∫≠p -->
      <div class="flex items-center justify-between border-b mb-4 bg-[#F8F8F8]">
        <h2 class="text-lg font-semibold text-gray-800 border-l-4 border-blue-400 pl-2 pb-2 pt-2">
          ƒêƒÇNG NH·∫¨P
        </h2>
        <lucide-icon name="user" class="w-5 h-5 text-gray-600 mr-2"></lucide-icon>
      </div>

      <div class="flex gap-3 mb-4">
        <button class="flex-1 border border-gray-300 py-2 rounded-md text-gray-600 hover:bg-gray-50 transition">
          ƒêƒÉng nh·∫≠p
        </button>
        <button class="flex-1 bg-[#3AA7E9] hover:bg-[#00456F] text-white py-2 rounded-md font-medium transition">
          Kh√°ch
        </button>
      </div>

      <div class="space-y-4 mb-6">
        <div>
          <label class="text-sm font-medium text-gray-700">Email</label>
          <input [(ngModel)]="checkoutData.customerEmail" type="text" placeholder="Nh·∫≠p Email"
            class="w-full mt-1 border border-gray-300 rounded-md px-3 py-2 text-sm outline-none focus:border-blue-400" />
        </div>
      </div>

      <!-- Th√¥ng tin thanh to√°n -->
      <div class="flex items-center justify-between border-b mb-4 bg-[#F8F8F8]">
        <h2 class="text-lg font-semibold text-gray-800 border-l-4 border-blue-400 pl-2 pb-2 pt-2">
          TH√îNG TIN THANH TO√ÅN
        </h2>
        <lucide-icon name="wallet" class="w-5 h-5 text-gray-600 mr-2"></lucide-icon>
      </div>

      <div class="space-y-4">
        <div>
          <label class="text-sm font-medium text-gray-700">H·ªç t√™n</label>
          <input [(ngModel)]="checkoutData.customerName" type="text" placeholder="Nh·∫≠p h·ªç t√™n"
            class="w-full mt-1 border border-gray-300 rounded-md px-3 py-2 text-sm outline-none focus:border-blue-400" />
        </div>

        <div>
          <label class="text-sm font-medium text-gray-700">S·ªë ƒëi·ªán tho·∫°i *</label>
          <input [(ngModel)]="checkoutData.customerPhone" type="text" placeholder="Nh·∫≠p SƒêT"
            class="w-full mt-1 border border-gray-300 rounded-md px-3 py-2 text-sm outline-none focus:border-blue-400" />
        </div>

        <div>
          <label class="text-sm font-medium text-gray-700">ƒê·ªãa ch·ªâ *</label>
          <input type="text" [(ngModel)]="checkoutData.shippingAddress" placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ"
            class="w-full mt-1 border border-gray-300 rounded-md px-3 py-2 text-sm outline-none focus:border-blue-400" />
        </div>
      </div>
    </div>

    <!-- üß± C·ªòT PH·∫¢I (7/10): Th√¥ng tin ƒë∆°n h√†ng -->
    <div class="lg:col-span-7 bg-white shadow-[0_4px_20px_rgba(9,9,81,0.05)] rounded-lg p-6">
      <!-- ƒê∆°n h√†ng -->
      <div class="flex items-center justify-between border-b mb-4 bg-[#F8F8F8]">
        <h2 class="text-lg font-semibold text-gray-900 border-l-4 border-blue-400 pl-2 pb-2 pt-2">
          TH√îNG TIN ƒê∆†N H√ÄNG
        </h2>
        <lucide-icon name="shopping-cart" class="w-5 h-5 text-gray-600 mr-2"></lucide-icon>
      </div>

      <!-- <div class="space-y-3">
        @if (cartItems.length > 0) {
        @for (item of cartItems; track item.id) {
        <div class="grid items-center gap-4
               grid-cols-[minmax(0,9fr)_minmax(0,2fr)_minmax(0,2fr)_auto]
               bg-gray-50 p-3 rounded-md">
          <div class="flex items-center gap-3 min-w-0">
            <img [src]="item.mainImageUrl" alt="{{ item.name }}" class="w-14 h-14 object-contain flex-shrink-0" />
            <div class="min-w-0">
              <p class="font-medium text-gray-800 text-sm leading-tight truncate">
                {{ item.name }}
              </p>
              <p class="text-xs text-gray-500">
                M√£ s·∫£n ph·∫©m: {{ item.sku }}
              </p>
            </div>
          </div>
          <div class="flex items-center justify-center gap-2">
            <button (click)="decreaseQty(item)" class="w-8 h-8 flex items-center justify-center rounded-md
           border border-gray-300 text-gray-600 hover:text-[#00456F] ">
              ‚àí
            </button>

            <span class="w-6 text-center text-sm font-medium">
              {{ item.quantity }}
            </span>

            <button (click)="increaseQty(item)" class="w-8 h-8 flex items-center justify-center rounded-md
           border border-gray-300 text-gray-600" [ngClass]="{ 'text-[#3AA7E9]': item.quantity <= item.lastQuantity }">
              +
            </button>
          </div>
          <div class="text-right">
            <p class="font-semibold text-gray-800 text-base min-w-[80px]">
              {{ item.salePrice | number: '1.0-0' }}ƒë
            </p>
          </div>
          <button (click)="removeItem(item)" class="flex items-center justify-center
                 w-8 h-8 rounded-full
                 border border-gray-200 bg-white
                 text-gray-400
                 hover:border-red-500 hover:text-red-500
                 transition-colors">
            <lucide-icon name="x" class="w-3 h-3"></lucide-icon>
          </button>
        </div>
        }
        } @else {
        <div class="text-center text-gray-500 py-6 border rounded-md bg-gray-50">
          üõí Hi·ªán t·∫°i ch∆∞a c√≥ s·∫£n ph·∫©m n√†o trong gi·ªè h√†ng
        </div>
        }
      </div> -->
      <div class="space-y-3">
        @if (cartItems.length > 0) { @for (item of cartItems; track item.id) {

        <!-- 1 ITEM -->
        <div
          class="bg-gray-50 p-3 rounded-md grid gap-4 items-center grid-cols-1 md:grid-cols-[minmax(0,9fr)_minmax(0,2fr)_minmax(0,2fr)_auto]">
          <!-- ROW 1: IMAGE + NAME -->
          <div class="flex items-center gap-3 min-w-0">
            <img [src]="item.mainImageUrl" alt="{{ item.name }}" class="w-14 h-14 object-contain flex-shrink-0" />
            <div class="min-w-0">
              <p class="font-medium text-gray-800 text-sm leading-tight truncate">
                {{ item.name }}
              </p>
              <p class="text-xs text-gray-500">M√£ s·∫£n ph·∫©m: {{ item.sku }}</p>
            </div>
          </div>

          <!-- ROW 2 (MOBILE): QTY + PRICE -->
          <div class="flex items-center justify-between md:contents">
            <!-- QTY -->
            <div class="flex items-center justify-center gap-2">
              <button (click)="decreaseQty(item)"
                class="w-8 h-8 flex items-center justify-center rounded-md border border-gray-300 text-gray-600 hover:text-[#00456F]">
                ‚àí
              </button>

              <span class="w-6 text-center text-sm font-medium">
                {{ item.quantity }}
              </span>

              <button (click)="increaseQty(item)"
                class="w-8 h-8 flex items-center justify-center rounded-md border border-gray-300 text-gray-600"
                [ngClass]="{
                  'text-[#3AA7E9]': item.quantity <= item.lastQuantity
                }">
                +
              </button>
            </div>

            <!-- PRICE -->
            <div class="text-right md:text-right">
              <p class="font-semibold text-gray-800 text-base min-w-[80px]">
                {{ item.salePrice | number : "1.0-0" : "vi" }}ƒë
              </p>
            </div>
          </div>
          <!-- DELETE -->
          <div class="flex justify-end md:justify-center">
            <button (click)="removeItem(item)"
              class="flex items-center justify-center w-8 h-8 rounded-full border border-gray-200 bg-white text-gray-400 hover:border-red-500 hover:text-red-500 transition-colors">
              <lucide-icon name="x" class="w-3 h-3"></lucide-icon>
            </button>
          </div>
        </div>
        } } @else {

        <!-- EMPTY -->
        <div class="text-center text-gray-500 py-6 border rounded-md bg-gray-50">
          üõí Hi·ªán t·∫°i ch∆∞a c√≥ s·∫£n ph·∫©m n√†o trong gi·ªè h√†ng
        </div>

        }
      </div>

      <div class="flex justify-between mt-4 text-lg text-gray-700">
        <span>T·ªïng s·ªë ti·ªÅn</span>
        <span class="font-bold text-black">{{ getTotal() | number : "1.0-0" : "vi" }}ƒë</span>
      </div>

      <!-- Ghi ch√∫ -->
      <div class="flex items-center justify-between border-b mb-4 bg-[#F8F8F8] mt-8">
        <h2 class="text-lg font-semibold text-gray-800 border-l-4 border-blue-400 pl-2 pb-2 pt-2">
          GHI CH√ö TH√äM
        </h2>
        <lucide-icon name="notepad-text" class="w-5 h-5 text-gray-600 mr-2"></lucide-icon>
      </div>
      <textarea [(ngModel)]="checkoutData.note" rows="3" placeholder="Nh·∫≠p ghi ch√∫ ƒë∆°n h√†ng..."
        class="w-full border border-gray-300 rounded-md p-3 text-sm outline-none focus:border-blue-400"></textarea>

      <!-- Ch√≠nh s√°ch -->
      <div class="flex items-center gap-2 mt-4 text-sm">
        <input type="checkbox" id="policy" [(ngModel)]="policyAccepted" class="w-4 h-4" />
        <label for="policy" class="text-gray-700">T√¥i ƒë·ªìng √Ω v·ªõi ƒëi·ªÅu kho·∫£n v√† ch√≠nh s√°ch</label>
      </div>

      <!-- N√∫t ƒë·∫∑t h√†ng -->
      <div class="flex justify-end mt-6">
        <button (click)="submitOrder()"
          class="bg-[#3AA7E9] hover:bg-[#00456F] text-white px-8 py-2 rounded-md font-semibold">
          ƒê·∫∑t h√†ng
        </button>
      </div>
    </div>
  </div>
</section>